<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bassin de la Muette</title>

<style>
:root {
    --overlay-light: rgba(255,255,255,0.2);
    --pink-text: #1c3d4a;
    --radius: 25px;
}

body {
    background: linear-gradient(to bottom, #E6D0AF, #9fc8b6, #65A8AB, #9fc8b6, #E6D0AF);
    background-size: 100% 250vh;
    margin: 0;
    font-family: Helvetica, Arial, sans-serif;
    padding: 30px 0;
}

/* ================= MAIN GRID ================= */

.container {
    display: grid;
    grid-template-columns: 350px 1fr 420px;
    grid-template-rows: auto auto auto;
    gap: 30px;
    max-width: 1200px;
    margin: 0 auto;
}
/* ================= BANNER ================= */

.banner {
    grid-column: 1;
    grid-row: 1;
    width: 100%;
    max-height: 160px;
    object-fit: contain;
}

/* ================= DESCRIPTION BOX ================= */

.card-tall {
    grid-column: 1;
    grid-row: 2;
    background: var(--overlay-light);
    border-radius: var(--radius);
    padding: 25px;
    align-self: start;
    margin-top: 10px; 
    z-index: 4  /* adjust this value until visually perfect */
}

.hero-description {
    color: #1c3d4a;
    font-size: 1.1rem;
    line-height: 1.6;
    margin: 0;
    z-index: 5
}

/* ================= HERO IMAGE ================= */

.hero-shape {
    grid-column: 2 / span 2;
    grid-row: 1 / span 2;
    border-radius: var(--radius);
    background-image: url('Bassin_Muette.jpg');
    border-radius: 25px;
    max-width: 750px;
    max-height: 100px;
    /* width: 100%; */
    /* background-size: cover; */
    background-position: center;
    padding: 40px;
    position: relative;
    display: flex;
    align-items: flex-start;
    z-index: 1;
}

.hero-shape h1 {
    color: white;
    font-size: 2.5rem;
    font-weight: 800;
    margin: 0;
}

/* ================= LILYPAD SQUARE ================= */

.lilypad-row {
    grid-column: 3;
    grid-row: 2;
    background: var(--overlay-light);
    border-radius: var(--radius);
    padding: 30px;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 25px;
    justify-items: center;
    align-self: start;
    margin-top: 10px;   /* adjust this value until visually perfect */
}

.rectangle {
    width: 130px;
    height: 130px;
    background: url('Text_box_2_red.png') no-repeat center center;
    background-size: contain;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    font-size: 18px;
    color: #1c3d4a;
    cursor: pointer;
    transition: transform 0.2s ease;
}

.rectangle:hover {
    transform: scale(1.1);
}

/* ================= INFO CARDS ================= */

.info-card {
    display: none;
    grid-column: 3;
    grid-row: 4;
    padding: 25px;
    background: var(--overlay-light);
    border-radius: var(--radius);
    text-align: center;
}

/* ================= FROG ================= */

#frog {
    position: fixed;
    bottom: -50px;
    left: 400px;
    width: 200px;
    z-index: 100;
    pointer-events: none;
}

/* ================= SPEECH ================= */

.speech-container {
    position: fixed;
    bottom: 240px;
    left: 400px;
    z-index: 101;
    display: flex;
    align-items: flex-end;
    gap: 8px;
}

.speech-bubble {
    max-width: 300px;
    background: white;
    border: 3px solid #1c3d4a;
    border-radius: 18px;
    padding: 12px 14px;
    font-size: 18px;
    color: #1c3d4a;
    box-shadow: 2px 4px 8px rgba(0,0,0,0.15);
    position: relative;
}

.speech-bubble::after {
    content: "";
    position: absolute;
    bottom: -12px;
    left: 30px;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-top: 12px solid white;
}

.speech-next {
    background: #1c3d4a;
    color: white;
    border: none;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    cursor: pointer;
}

/* ================= DECORATIVE CORNERS ================= */

.corner {
    position: fixed;
    width: 270px;
    pointer-events: none;
    z-index: 2;
}

.top-right { top: 0; right: 0; }
.bottom-left { bottom: 0; left: 0; }

</style>
</head>

<body>

<!-- Decorative Lily Pads -->
<img src="nenuphar.png" class="corner top-right">
<img src="nenuphar_4.png" class="corner bottom-left">

<div class="container">

    <!-- Banner -->
    <img src="banner2.png" class="banner">

    <!-- Description -->
    <div class="card-tall">
        <p class="hero-description">
            Since 20--, the Bassin de la Muette has been suffering from toxic algae proliferation.<br><br>
            Aquatic life struggles due to oxygen depletion and reduced light penetration.<br><br>
            Floom monitors the lake in real time to restore ecological balance.
        </p>
    </div>

    <!-- Hero Image -->
    <div class="hero-shape">
        <h1>Welcome to the<br>Bassin de la Muette</h1>
    </div>

    <!-- LilyPad Square -->
    <div class="lilypad-row">
        <div class="rectangle" data-type="temperature">Temperature
        <!-- <div class="rectangle" onClick = "document.getElementById('temperature-card').scrollIntoView();" data-type="temperature">Temperature -->
            <!-- <input class = "rectna" onClick = "document.getElementById('temperature-card').scrollIntoView();"/> -->
        </div>
        <div class="rectangle" data-type="ph">pH</div>
        <div class="rectangle" data-type="turbidity">Turbidity</div>
        <div class="rectangle" data-type="conductivity">Conductivity</div>
    </div>

    <!-- Info Cards -->
    <div class="info-card" id="temperature-card">
        <h2>Lake Temperature</h2>
        <p>Current temperature: <strong id="temperature">--</strong></p>
        <p class="evolution-placeholder">[Evolution over time will be added here]</p>
    </div>

    <div class="info-card" id="turbidity-card">
        <h2>Lake Turbidity</h2>
        <p>Current turbidity: <strong id="turbidity">--</strong></p>
        <p class="evolution-placeholder">[Evolution over time will be added here]</p>
    </div>

    <div class="info-card" id="ph-card">
        <h2>Lake pH</h2>
        <p>Current pH: <strong>5</strong></p>
        <p class="evolution-placeholder">[Evolution over time will be added here]</p>
    </div>

    <div class="info-card" id="conductivity-card">
        <h2>Lake Conductivity</h2>
        <p>Current conductivity: <strong id="conductivity">--</strong></p>
        <p class="evolution-placeholder">[Evolution over time will be added here]</p>
    </div>

    <!-- scroll down -->
    <!-- <input class = "lilypad-row" onClick = "document.getElementById('temperature-card').scrollIntoView();"/> -->

</div>

<!-- Frog -->
<img id="frog" src="sargouset/images/eo_mc.png" alt="Sargouset">

<!-- Speech -->
<div class="speech-container" id="speech-container">
    <div class="speech-bubble">
        <span id="speech-text">
            Hi! I'm Sargouset, your guide around the lake's health.
        </span>
    </div>
    <button class="speech-next" id="speech-next">â–¶</button>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {

    /* ðŸ¸ Frog animation */
    const frog = document.getElementById("frog");
    let currentEyes="eo", currentMouth="mc";
    const basePath="sargouset/images/";

    function updateFrame(){
        frog.src = basePath + currentEyes + "_" + currentMouth + ".png";
    }

    function blink(){
        const seq=["esc","ec","esc"]; let i=0;
        const interval=setInterval(()=>{
            currentEyes=seq[i]; updateFrame(); i++;
            if(i>=seq.length){
                clearInterval(interval);
                currentEyes="eo"; updateFrame();
            }
        },100);
    }

    setInterval(()=>{ blink(); },4000+Math.random()*3000);

    let talkingInterval, talkCycles=0;
    function startTalking(){
        const mouths=["mc","mso","mo","mso"]; let i=0; talkCycles=0;
        talkingInterval=setInterval(()=>{
            currentMouth=mouths[i]; updateFrame();
            i=(i+1)%mouths.length;
            if(i===0) talkCycles++;
            if(talkCycles>=10) stopTalking();
        },120);
    }
    function stopTalking(){
        clearInterval(talkingInterval);
        currentMouth="mc"; updateFrame();
    }
    startTalking();
    setInterval(()=>{ startTalking(); },7000);

    /* ðŸ—¨ï¸ Speech logic */
    const messages=[
        "Hi! I'm Sargouset, your guide around the lake's health.",
        "Click on a lilypad to see how the lake is doing!"
    ];
    let messageIndex=0;
    const speechText=document.getElementById("speech-text");

    document.getElementById("speech-next").addEventListener("click",()=>{
        messageIndex++;
        if(messageIndex<messages.length){
            speechText.textContent=messages[messageIndex];
        } else {
            document.getElementById("speech-container").style.display="none";
        }
    });

    /* ðŸŒ¿ Lilypad clicks */
    const rectangles=document.querySelectorAll(".rectangle");
    const parameterInfo={
        temperature:"The temperature shows how warm the lake is.",
        turbidity:"Turbidity shows how clear or cloudy the water is.",
        ph:"pH defines the lake's acidity.",
        conductivity:"Conductivity measures dissolved minerals."
    };

    rectangles.forEach(rect=>{
        rect.addEventListener("click",()=>{
            const type=rect.dataset.type;
            document.querySelectorAll(".info-card")
                .forEach(card=>card.style.display="none");
            document.getElementById(type+"-card").style.display="block";
            speechText.textContent=parameterInfo[type];
            document.getElementById("speech-container").style.display="flex";
        });

    });

    rectangles.forEach(rect => {
        rect.addEventListener("click", () => {
            const type = rect.dataset.type;
            document.querySelectorAll(".info-card")
            .forEach(card => card.style.display = "none");
            
            const card = document.getElementById(type + "-card");
            card.style.display = "block";
            card.scrollIntoView({ behavior: "smooth", block: "start" });
            speechText.textContent = parameterInfo[type];
            document.getElementById("speech-container").style.display = "flex";
        });
    });



// ðŸŒŠ Optional: Thingspeak turbidity (doesn't interfere with lilypad clicks)
  const channelID = "3267133";
  const readAPIKey = "51RMF6RF0SNM01AP";

  async function fetchTurbidity(){
      try {
          const response = await fetch(`https://api.thingspeak.com/channels/${channelID}/feeds.json?api_key=${readAPIKey}&results=1`);
          const data = await response.json();
          const last = data.feeds[0];
          if(last){
              document.getElementById("turbidity").textContent = last.field1;
          }
      } catch(err){
          console.error("Error fetching turbidity:", err);
      }
  }

  fetchTurbidity();
  setInterval(fetchTurbidity, 15000);
    
  async function fetchConductivity(){
      try {
          const response = await fetch(`https://api.thingspeak.com/channels/${channelID}/feeds.json?api_key=${readAPIKey}&results=1`);
          const data = await response.json();
          const last = data.feeds[0];
          if(last){
              document.getElementById("conductivity").textContent = last.field2;
          }
      } catch(err){
          console.error("Error fetching conductivity:", err);
      }
  }

  fetchConductivity();
  setInterval(fetchConductivity, 15000);

  async function fetchTemperature(){
      try {
          const response = await fetch(`https://api.thingspeak.com/channels/${channelID}/feeds.json?api_key=${readAPIKey}&results=1`);
          const data = await response.json();
          const last = data.feeds[0];
          if(last){
              document.getElementById("temperature").textContent = last.field3;
          }
      } catch(err){
          console.error("Error fetching temperature:", err);
      }
  }

  fetchTemperature();
  setInterval(fetchTemperature, 15000);

}); // end DOMContentLoaded
</script>


</body>
</html>
